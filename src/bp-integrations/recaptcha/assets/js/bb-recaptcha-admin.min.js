!function(i){var e={init:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){this.selected_version=i('input[name="bb_recaptcha[recaptcha_version]"]:checked').val(),this.v2_option=i('.recaptcha_v2:visible input[name="bb_recaptcha[v2_option]"]:checked').val(),this.site_key="",this.secret_key="",this.captcha_response="",i(".bb-recaptcha-settings form table.bb-inactive-field").length&&(i(".bb-recaptcha-settings form #bb_recaptcha_settings table").removeClass("bb-inactive-field"),i(".bb-recaptcha-settings form #bb_recaptcha_design table").removeClass("bb-inactive-field")),i(".bb-recaptcha-settings .section-bb_recaptcha_versions .bb-recaptcha-status .not-connected").length&&(i(".bb-recaptcha-settings form #bb_recaptcha_settings table").addClass("bb-inactive-field"),i(".bb-recaptcha-settings form #bb_recaptcha_design table").addClass("bb-inactive-field"))},addListeners:function(){i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("keyup","#bb-recaptcha-site-key, #bb-recaptcha-secret-key",this.enableVerifyButton.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("click",".recaptcha-verification",this.recaptchaVerifications.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("click","#recaptcha_submit",this.recaptchaSubmit.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("click","#recaptcha_verified",this.recaptchaVerified.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("click",".close-modal, #recaptcha_cancel",this.recaptchaVerificationPopupClose.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("change",'input[name="bb_recaptcha[recaptcha_version]"]',this.recaptchaVersion.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_versions").on("change",'input[name="bb_recaptcha[v2_option]"]',this.recaptchaType.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_design").on("change",'input[name="bb_recaptcha[theme]"]',this.recaptchaTheme.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_settings").on("change","#recaptcha_bb_login",this.allowByPass.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_settings").on("change","#bb_recaptcha_allow_bypass",this.enableBypassInputAndToggle.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_settings").on("keyup",'input[name="bb_recaptcha[bypass_text]"]',this.updateByPassUrl.bind(this)),i(".buddyboss_page_bp-integrations .section-bb_recaptcha_settings").on("click",".bb_login_require .bb-copy-button",this.copyByPassUrl.bind(this))},enableVerifyButton:function(e){e.preventDefault();var t=i("#bb-recaptcha-site-key").val(),a=i("#bb-recaptcha-site-key").attr("data-old-value"),c=i("#bb-recaptcha-secret-key").val(),e=i("#bb-recaptcha-secret-key").attr("data-old-value");""!==t&&""!==c?(i(".verify-row").removeClass("bp-hide"),i(".recaptcha-verification").removeAttr("disabled"),i(".bb-recaptcha-settings form .submit input").attr("disabled","disabled"),""===i('input[name="bb_recaptcha[recaptcha_version]"]:checked').val()||t===a&&c===e?(i(".verify-row").addClass("bp-hide"),i(".recaptcha-verification").attr("disabled","disabled"),i(".bb-recaptcha-settings form .submit input").removeAttr("disabled")):(i(".verify-row").removeClass("bp-hide"),i(".recaptcha-verification").removeAttr("disabled"),i(".bb-recaptcha-settings form .submit input").attr("disabled","disabled"))):(i(".verify-row").removeClass("bp-hide"),i(".recaptcha-verification").attr("disabled","disabled"),i(".bb-recaptcha-settings form .submit input").removeAttr("disabled"))},recaptchaVersion:function(e){var t;e.preventDefault(),"recaptcha_v3"===e.currentTarget.value?(i(".recaptcha_v3").removeClass("bp-hide"),i(".recaptcha_v2").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v2").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v3").removeClass("bp-hide")):(i(".recaptcha_v2").removeClass("bp-hide"),i(".recaptcha_v3").addClass("bp-hide"),void 0!==(t=i('.recaptcha_v2 input[name="bb_recaptcha[v2_option]"]:checked').val())&&"v2_invisible_badge"===t?(i("#bp-hello-content-recaptcha_v2").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v3").removeClass("bp-hide")):(i("#bp-hello-content-recaptcha_v2").removeClass("bp-hide"),i("#bp-hello-content-recaptcha_v3").addClass("bp-hide"))),this.selected_version!==e.currentTarget.value||"recaptcha_v2"===e.currentTarget.value&&this.v2_option!==i('.recaptcha_v2:visible input[name="bb_recaptcha[v2_option]"]:checked').val()?(i(".verify-row").removeClass("bp-hide"),i(".recaptcha-verification").removeAttr("disabled"),i(".bb-recaptcha-settings form .submit input").attr("disabled","disabled")):(i(".verify-row").addClass("bp-hide"),i(".recaptcha-verification").attr("disabled","disabled"),i(".bb-recaptcha-settings form .submit input").removeAttr("disabled"))},recaptchaType:function(e){e.preventDefault(),this.v2_option!==e.currentTarget.value?(i(".verify-row").removeClass("bp-hide"),i(".recaptcha-verification").removeAttr("disabled"),i(".bb-recaptcha-settings form .submit input").attr("disabled","disabled")):(i(".verify-row").addClass("bp-hide"),i(".recaptcha-verification").attr("disabled","disabled"),i(".bb-recaptcha-settings form .submit input").removeAttr("disabled")),i(".recaptcha-v2-fields p.description").addClass("bp-hide"),i("."+e.currentTarget.value+"_description").removeClass("bp-hide"),"v2_checkbox"===e.currentTarget.value?(i(".recaptcha_v2_checkbox").removeClass("bp-hide"),i(".recaptcha_v2_invisible").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v2").removeClass("bp-hide"),i("#bp-hello-content-recaptcha_v3").addClass("bp-hide")):(i(".recaptcha_v2_invisible").removeClass("bp-hide"),i(".recaptcha_v2_checkbox").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v2").addClass("bp-hide"),i("#bp-hello-content-recaptcha_v3").removeClass("bp-hide"))},recaptchaTheme:function(e){e.preventDefault(),"dark"===e.currentTarget.value?i('input[name="bb_recaptcha[size]"] + label').removeClass("opt-size-light").addClass("opt-size-dark"):i('input[name="bb_recaptcha[size]"] + label').removeClass("opt-size-dark").addClass("opt-size-light")},recaptchaVerifications:function(e){e.preventDefault();var t=this;i(document).find("#bp-hello-backdrop").length||(c=i(document).find(".bp-hello-recaptcha"),i('<div id="bp-hello-backdrop" style="display: none;"></div>').insertBefore(c));var a,e=document.getElementById("bp-hello-backdrop"),c=document.getElementById("bp-hello-container");null!==e&&(document.body.classList.add("bp-disable-scroll"),e.style.display="",c.style.display="",t.selected_version=i('input[name="bb_recaptcha[recaptcha_version]"]:checked').val(),t.site_key=i("#bb-recaptcha-site-key").val(),t.secret_key=i("#bb-recaptcha-secret-key").val(),window.bb_recaptcha_script=document.createElement("script"),i('input[name="bb_recaptcha[v2_option]"]').length&&(t.v2_option=i('input[name="bb_recaptcha[v2_option]"]:checked').val()),a=this.fetchSelector(),"recaptcha_v3"===t.selected_version&&(window.bb_recaptcha_script.src="https://www.google.com/recaptcha/api.js?onload=bb_recaptcha_v3_verify&render="+t.site_key),"recaptcha_v2"===t.selected_version&&t.v2_option&&("v2_checkbox"===t.v2_option&&(window.bb_recaptcha_script.src="https://www.google.com/recaptcha/api.js?onload=bb_recaptcha_v2_verify&render=explicit"),"v2_invisible_badge"===t.v2_option&&(window.bb_recaptcha_script.src="https://www.google.com/recaptcha/api.js?onload=bb_recaptcha_v2_verify_invisible&render=explicit",i("body").append('<div id="v2_invisible_footer"></div>'))),window.bb_recaptcha_script.onerror=function(){console.log("error")},window.bb_recaptcha_v3_verify=function(){"object"==typeof grecaptcha&&grecaptcha.ready(function(){grecaptcha.execute(t.site_key,{action:"bb_recaptcha_admin_verify"}).then(function(e){t.captcha_response=e,i("#"+a+" .verifying_token").hide(),i("#"+a+" .verified_token").show()})})},window.bb_recaptcha_v2_verify=function(){window.bb_recaptcha_box=grecaptcha.render("verifying_token",{sitekey:t.site_key,theme:"light",callback:function(){t.captcha_response=grecaptcha.getResponse(window.bb_recaptcha_box)}})},window.bb_recaptcha_v2_verify_invisible=function(){window.bb_recaptcha_invisible=grecaptcha.render("v2_invisible_footer",{sitekey:t.site_key,tabindex:9999,size:"invisible",callback:function(e){t.captcha_response=e,i("#"+a+" .verifying_token").hide(),i("#"+a+" .verified_token").show()}}),grecaptcha.execute()},i("#recaptcha_submit").removeAttr("disabled"),document.head.appendChild(window.bb_recaptcha_script))},recaptchaSubmit:function(t){t.preventDefault();var e=this;i(t.currentTarget).attr("disabled","disabled");var a={action:"bb_recaptcha_verification_admin_settings",nonce:bbRecaptchaAdmin.nonce,selected_version:e.selected_version,site_key:e.site_key,secret_key:e.secret_key,captcha_response:e.captcha_response};e.v2_option&&(a.v2_option=e.v2_option);var c=this.fetchSelector();i.ajax({type:"POST",url:bbRecaptchaAdmin.ajax_url,data:a,success:function(e){i(t.currentTarget).removeAttr("disabled"),e.success&&void 0!==e.data?(i("#"+c).html(e.data),i(".bb-popup-buttons").html('<button id="recaptcha_verified" class="button">'+bbRecaptchaAdmin.bb_recaptcha_ok+"</button>"),document.head.removeChild(window.bb_recaptcha_script),window.bb_recaptcha_script=null,window.bb_recaptcha_v3_verify=null,window.bb_recaptcha_box=null,window.bb_recaptcha_v2_verify=null,window.bb_recaptcha_invisible=null,window.bb_recaptcha_v2_verify_invisible=null):(i("#"+c).html(e.data),i(".bb-popup-buttons").html('<button id="recaptcha_cancel" class="button">'+bbRecaptchaAdmin.bb_recaptcha_ok+"</button>"))}})},recaptchaVerified:function(e){e.preventDefault(),window.location.reload()},recaptchaVerificationPopupClose:function(e){e.preventDefault(),window.location.reload()},fetchSelector:function(){var e=this;return"recaptcha_v3"===e.selected_version||"recaptcha_v2"===e.selected_version&&e.v2_option&&"v2_invisible_badge"===e.v2_option?"bp-hello-content-recaptcha_v3":"bp-hello-content-recaptcha_v2"},allowByPass:function(e){e.currentTarget.checked?i(".bb_login_require").removeClass("bp-hide"):i(".bb_login_require").addClass("bp-hide")},enableBypassInputAndToggle:function(e){e.currentTarget.checked?(i('.bb_login_require input[name="bb_recaptcha[bypass_text]"]').removeAttr("disabled"),i(".bb_login_require .copy-toggle").removeClass("bp-hide")):(i('.bb_login_require input[name="bb_recaptcha[bypass_text]"]').attr("disabled","disabled"),i(".bb_login_require .copy-toggle").addClass("bp-hide"))},updateByPassUrl:function(e){e.preventDefault();var t="xxUNIQUE_STRINGXS";(t=e.currentTarget.value?e.currentTarget.value:t).length<6?(i(".bb_login_require .copy-toggle").addClass("bb-url-not-allowed"),i(".bb_login_require .bb-copy-button").addClass("bp-hide")):(i(".bb_login_require .copy-toggle").removeClass("bb-url-not-allowed"),i(".bb_login_require .bb-copy-button").removeClass("bp-hide"));t=i(".copy-toggle-text").data("domain")+t;i(".copy-toggle-text").attr("href",t),i(".copy-toggle-text").html(t)},copyByPassUrl:function(e){e.preventDefault();var t=i(e.currentTarget).html(),a=i(".copy-toggle-text").attr("href"),c=i("<input>");i("body").append(c),c.val(a).select(),document.execCommand("copy"),c.remove(),i(e.currentTarget).text(i(e.currentTarget).data("copied-text")),setTimeout(function(){i(e.currentTarget).html(t)},2e3)}};i(function(){e.init()})}(jQuery);
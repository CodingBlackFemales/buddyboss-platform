window.bp=window.bp||{},function(e,t){if("undefined"!=typeof BP_Nouveau){var i=t("#profile-edit-form .repeater_group_outer").length;if(i>0){var r=[];t("#profile-edit-form .repeater_group_outer").each(function(){var e=t(this);r.push(e.data("set_no")),i>1&&e.find(".repeater_group_inner").hide();var a="";e.find(".editfield").each(function(){var e=t(this).find("input[type=text],input[type=number],input[type=email],input[type=phone],input:checked,textarea,select").val(),i=t(this).find("input[type=text],input[type=number],input[type=email],input[type=phone],input:checked,textarea,select").attr("name"),r=(i?i.split("_"):"").indexOf("visibility")>-1;if(""!==t.trim(e)&&!r)return a=t.trim(e),!1}),""===a?(e.find(".repeater_set_title").addClass("repeater_set_title_empty"),e.find(".repeater_set_title").html(BP_Nouveau.empty_field)):e.find(".repeater_set_title").html(a)}),t("#profile-edit-form").append('<input type="hidden" name="repeater_set_sequence" value="'+r.join(",")+'">'),t(".repeater_sets_sortable").sortable({items:".repeater_group_outer",update:function(){var e=[];t("#profile-edit-form .repeater_group_outer").each(function(){e.push(t(this).data("set_no"))}),t('#profile-edit-form [name="repeater_set_sequence"]').val(e.join(","))}})}t("#profile-edit-form .repeater_group_outer .repeater_set_edit").click(function(e){e.preventDefault(),t(this).closest(".repeater_group_outer").find(".repeater_group_inner").slideToggle(),t(this).parents(".repeater_group_outer").toggleClass("active")}),window.location.href.indexOf("#bpxpro")>-1&&(t("#profile-edit-form .repeater_group_outer:last-of-type").find(".repeater_group_inner").slideToggle(),t("#profile-edit-form .repeater_group_outer:last-of-type").toggleClass("active"));var a=[];t("#profile-edit-form .repeater_group_outer .repeater_set_delete").click(function(e){var i=t(this);if((e.preventDefault(),!i.hasClass("disabled"))&&confirm(BP_Nouveau.confirm_delete_set)){i.closest(".repeater_group_outer").find(".editfield").each(function(){var e=t(this),i=e.find("input,textarea,select").attr("name");void 0!==(i=void 0!==i?i:e.find("textarea.wp-editor-area").attr("name"))&&(i=(i=(i=i.replace("field_","")).replace("_day","")).replace("[]",""),a.push(i))}),i.closest(".repeater_group_outer").remove();var r=[];t("#profile-edit-form .repeater_group_outer").each(function(){r.push(t(this).data("set_no"))}),t('#profile-edit-form [name="repeater_set_sequence"]').val(r.join(","));for(var o=t('#profile-edit-form [name="field_ids"]').val().split(","),n=[],d=0;d<o.length;d++){for(var p=!1,l=0;l<a.length;l++)if(o[d]===a[l]){p=!0;break}p||n.push(o[d])}n=n.join(","),t('#profile-edit-form [name="field_ids"]').val(n),t('#profile-edit-form [name="deleted_field_ids"]').length||t("#profile-edit-form").append('<input type="hidden" name="deleted_field_ids" >'),t('#profile-edit-form [name="deleted_field_ids"]').val(a.join(",")),t("#profile-edit-form .repeater_group_outer").length}}),window.location.href.indexOf("#bpxpro")>0?document.addEventListener("DOMContentLoaded",function(){t.ajax({url:ajaxurl,method:"POST",data:{action:"bp_xprofile_check_repeater_set",field_ids:t("#field_ids").val()},success:function(e){"true"===e&&t("#profile-edit-form #btn_add_repeater_set").length&&(t("#profile-edit-form #btn_add_repeater_set").removeAttr("disabled"),t("#profile-edit-form #btn_add_repeater_set").css("pointer-events","auto"),t(".repeater_sets_sortable").sortable())}})}):t("#profile-edit-form #btn_add_repeater_set").length&&(t("#profile-edit-form #btn_add_repeater_set").removeAttr("disabled"),t("#profile-edit-form #btn_add_repeater_set").css("pointer-events","auto")),t("#profile-edit-form #btn_add_repeater_set").click(function(e){e.preventDefault();var i=t(this);i.hasClass("disabled")||(i.addClass("disabled"),i.attr("disabled","disabled"),i.css("pointer-events","none"),t.ajax({url:ajaxurl,method:"POST",data:{action:"bp_xprofile_add_repeater_set",_wpnonce:i.data("nonce"),group:i.data("group")},success:function(){history.pushState("",document.title,window.location.pathname),window.location.href+="#bpxpro",window.location.reload()}}))}),t(".field-visibility-settings").addClass("bp-hide"),t(".visibility-toggle-link").attr("aria-expanded","false"),t(".visibility-toggle-link").on("click",function(e){e.preventDefault(),t(this).attr("aria-expanded","true"),t(this).parent().addClass("field-visibility-settings-hide bp-hide").siblings(".field-visibility-settings").removeClass("bp-hide").addClass("field-visibility-settings-open")}),t(".field-visibility-settings-close").on("click",function(e){e.preventDefault();var i=t(this).parent(),r=t(".iradio_minimal").length>0?i.find("input:checked").parent().next(".field-visibility-text").text():i.find("input:checked").parent().text();i.removeClass("field-visibility-settings-open").addClass("bp-hide").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(r).end().addClass("bp-show").removeClass("field-visibility-settings-hide bp-hide"),t(".visibility-toggle-link").attr("aria-expanded","false")}),t("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var e=!0;t("#profile-edit-form #btn_add_repeater_set").addClass("disabled"),t("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){e=!1,t("#profile-edit-form #btn_add_repeater_set").removeClass("disabled")}),window.onbeforeunload=function(){if(e)return BP_Nouveau.unsaved_changes}}),window.clear=function(e){e&&(e=e.replace("[","\\[").replace("]","\\]"),t("#"+e+" option").length?t.each(t("#"+e+" option"),function(e,i){t(i).prop("selected",!1)}):t("#"+e+" [type=radio]").length&&t.each(t("#"+e+" [type=radio]"),function(e,i){t(i).prop("checked",!1)}))}}}(bp,jQuery);
